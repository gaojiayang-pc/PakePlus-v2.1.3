<!DOCTYPE html>
<html lang="zh-CN" data-theme="ios">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Timer V25.0 (Project Structure)</title>
    
    <!-- 字体库 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Roboto+Mono:wght@500;700&family=Comic+Neue:wght=700&family=JetBrains+Mono:wght@700&family=VT323&display=swap" rel="stylesheet">
    
    <!-- CSS 引用 -->
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <audio id="sfx-ding" src="https://cdn.jsdelivr.net/gh/tars-dev/cdn/sounds/ding.mp3"></audio>
    <audio id="sfx-bell" src="https://cdn.jsdelivr.net/gh/tars-dev/cdn/sounds/bell.mp3"></audio>

    <div id="toast-container"></div>
    <div id="custom-bg-layer"></div>
    <div id="bg-mask-layer"></div>
    <div id="atmosphere-layer"></div>

    <!-- 侧边栏 -->
    <div id="sidebar-overlay" onclick="View.toggleSidebar()"></div>
    <div id="theme-sidebar">
        <div id="sidebar-resizer"></div>
        <div class="sidebar-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2 style="margin:0; font-size:1.5rem;">外观设置</h2>
                <button onclick="View.toggleSidebar()" style="padding:5px 10px; background:transparent; border:none; font-size:1.2rem;">✕</button>
            </div>

            <label style="font-weight:bold; display:block; margin-bottom:10px;">图标风格 (Icon Style)</label>
            <div class="mode-switcher">
                <button class="mode-btn icon-type-btn" onclick="App.setIconType('emoji', this)">Emoji 🎨</button>
                <button class="mode-btn icon-type-btn" onclick="App.setIconType('line', this)">Line ✏️</button>
                <button class="mode-btn icon-type-btn" onclick="App.setIconType('solid', this)">Solid ⬛</button>
                <button class="mode-btn icon-type-btn" onclick="App.setIconType('duotone', this)">Duo 🌗</button>
            </div>

            <label style="font-weight:bold; display:block; margin-bottom:10px;">布局模式 (Layout)</label>
            <div class="mode-switcher">
                <button class="mode-btn display-mode-btn" onclick="App.setMode('standard', this)">标准</button>
                <button class="mode-btn display-mode-btn" onclick="App.setMode('icon', this)">图标</button>
                <button class="mode-btn display-mode-btn" onclick="App.setMode('text', this)">文字</button>
            </div>
            
            <div style="margin-bottom:20px; padding-bottom:15px; border-bottom:1px solid #ddd;">
                <div style="display:flex; justify-content:space-between; font-weight:bold; margin-bottom:5px;"><span>图标大小</span><span id="icon-size-val">3rem</span></div>
                <input type="range" min="1.5" max="5.0" step="0.1" value="3.0" style="width:100%;" oninput="View.updateIconSize(this.value)">
                <div style="display:flex; justify-content:space-between; font-weight:bold; margin-top:10px; margin-bottom:5px;"><span>卡片宽度</span><span id="grid-val">160px</span></div>
                <input type="range" min="100" max="300" step="10" value="160" style="width:100%;" oninput="View.updateGridSize(this.value)">
                <div style="display:flex; justify-content:space-between; font-weight:bold; margin-top:10px; margin-bottom:5px;"><span>圆角半径</span><span id="radius-val">Auto</span></div>
                <input type="range" min="0" max="50" step="1" value="20" style="width:100%;" oninput="View.updateRadius(this.value)">
            </div>

            <label style="font-weight:bold; display:block; margin-bottom:10px;">主题风格 (24款)</label>
            <div class="theme-grid" id="theme-list"></div>

            <div style="margin-top:30px; padding-top:20px; border-top:1px solid #ddd;">
                <label style="font-weight:bold; display:block; margin-bottom:10px;">自定义壁纸</label>
                <div class="input-group-row">
                    <input id="bg-input" class="input-compact" placeholder="图片 URL..." onchange="BgEngine.updateBg()">
                    <button class="btn-small" onclick="document.getElementById('bg-input').value='';BgEngine.updateBg()">清除</button>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; margin:10px 0 5px;"><span>背景遮罩</span><span id="mask-val">0%</span></div>
                <input type="range" min="0" max="0.8" step="0.1" value="0" style="width:100%;" oninput="BgEngine.updateMask(this.value)">
                <div style="margin-top:15px; display:flex; justify-content:space-between; align-items:center;">
                    <label style="font-weight:bold;">✨ 氛围粒子</label>
                    <input type="checkbox" id="particle-check" checked onchange="BgEngine.toggleParticles(this.checked)" style="width:20px; height:20px;">
                </div>
            </div>

            <div style="margin-top:20px; padding-top:20px; border-top:1px solid #ddd;">
                <label style="font-weight:bold; display:block; margin-bottom:10px;">配色 & 字体</label>
                <div style="display:flex; gap:10px; justify-content: center; margin-bottom:15px;">
                    <input type="color" onchange="document.documentElement.style.setProperty('--custom-text', this.value); localStorage.setItem('customText', this.value)" title="字体色" style="width:40px; height:40px; padding:0; border-radius:50%; overflow:hidden;">
                    <input type="color" onchange="document.documentElement.style.setProperty('--custom-accent', this.value); localStorage.setItem('customAccent', this.value)" title="主题色" style="width:40px; height:40px; padding:0; border-radius:50%; overflow:hidden;">
                    <button class="btn-small" onclick="localStorage.clear();location.reload()">重置</button>
                </div>
                <label style="font-weight:bold; display:block; margin-bottom:5px;">时间字体缩放</label>
                <input type="range" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;" oninput="document.documentElement.style.setProperty('--timer-scale', this.value)">
            </div>
        </div>
    </div>

    <!-- 顶部栏 -->
    <div id="top-bar">
        <button class="menu-btn" onclick="View.toggleSidebar()">
            <span style="font-size:1.2rem;margin-right:5px;">🎨</span> 设置
        </button>
        <button id="btn-home" class="menu-btn hidden" onclick="App.goHome()">🏠 主页</button>
        <div id="clock-real" style="font-family:var(--font-num); font-weight:700; background:var(--card-bg); padding:8px 15px; border-radius:20px; box-shadow:var(--shadow); border:var(--card-border);">00:00</div>
    </div>

    <div class="main-wrapper">
        <div id="page-home" class="page active">
            <div style="text-align:center; padding: 20px 0 40px;">
                <h1 style="font-size: 2.5rem; margin: 0; letter-spacing: -1px;">V25.0 Ultimate</h1>
                <p style="opacity:0.6;">组件化架构 · 极致性能</p>
            </div>
            <div class="home-grid" id="app-grid" data-mode="standard" data-icon="emoji"></div>
        </div>
        
        <!-- 各功能页 -->
        <div id="page-exam" class="page"><div class="timer-box"><div class="non-zen-content" style="border-bottom:1px solid rgba(0,0,0,0.1); padding-bottom:20px; margin-bottom:20px;"><h2>📝 考场模拟</h2><div style="display:flex; gap:10px;"><input id="ex-sub" value="高等数学" placeholder="科目" style="width:140px;"><input id="ex-dur" type="number" value="120" style="width:70px"> 分钟</div></div><div style="text-align:center;"><h1 id="disp-sub" style="margin:0;">科目名称</h1><p id="disp-status" style="font-weight:bold; opacity:0.6; margin:10px 0;">等待开考</p><div class="timer-container"><div class="time-display" id="exam-timer">00:00</div></div></div><div class="controls non-zen-content"><button class="btn-primary" onclick="Modules.Exam.start()">开始</button><button class="btn-accent hidden" id="btn-exam-stop" onclick="Modules.Exam.stop()">结束</button><button onclick="View.toggleZen()">全屏</button></div></div></div>
        <div id="page-pomo" class="page"><div class="timer-box" style="text-align:center;"><h2>🍅 番茄专注</h2><div class="timer-container"><div class="time-display" id="pomo-timer">25:00</div></div><div class="controls"><button class="btn-primary" onclick="Modules.Pomo.start()">开始</button><button onclick="Modules.Pomo.reset()">重置</button></div></div></div>
        <div id="page-whiteboard" class="page"><div class="timer-box"><div style="display:flex; justify-content:space-between; margin-bottom:15px;"><h2>🎨 白板</h2><button onclick="Modules.Whiteboard.clear()">清空</button></div><div style="display:flex; gap:10px; margin-bottom:10px; justify-content:center;"><button style="width:30px;height:30px;border-radius:50%;background:#000;" onclick="Modules.Whiteboard.color='#000'"></button><button style="width:30px;height:30px;border-radius:50%;background:#d63031;" onclick="Modules.Whiteboard.color='#d63031'"></button><button style="width:30px;height:30px;border-radius:50%;background:#0984e3;" onclick="Modules.Whiteboard.color='#0984e3'"></button><button style="width:30px;height:30px;border-radius:50%;background:#fff;border:1px solid #ccc;" onclick="Modules.Whiteboard.color='#fff';Modules.Whiteboard.width=20"></button></div><canvas id="wb-canvas" width="800" height="400" style="background:#fff; width:100%; border-radius:12px; cursor:crosshair; box-shadow:inset 0 0 10px rgba(0,0,0,0.05);"></canvas></div></div>
        <div id="page-media" class="page"><div class="timer-box"><h2>📺 媒体</h2><div class="media-drop-zone" onclick="document.getElementById('media-input').click()" style="border:2px dashed rgba(0,0,0,0.2); padding:40px; text-align:center; border-radius:12px; cursor:pointer;">📂 选择视频/音频文件<input type="file" id="media-input" hidden accept="video/*,audio/*" onchange="Modules.Media.load(this)"></div><div id="media-container" class="hidden" style="margin-top:20px;"><video id="video-player" controls style="width:100%; border-radius:12px; background:#000;"></video></div></div></div>
        <div id="page-schedule" class="page"><div class="timer-box"><h2>📅 日程</h2><div id="schedule-list" style="margin:20px 0;"></div><div class="controls"><button onclick="Modules.Schedule.add()">+ 添加</button><button class="btn-accent" onclick="Modules.Schedule.clear()">清空</button></div></div></div>
        <div id="page-countdown" class="page"><div class="timer-box"><h2>⏱️ 倒计时</h2><div class="controls"><input id="cd-input" type="number" value="10" style="width:60px"> 分</div><div class="timer-container"><div class="time-display" id="cd-timer">10:00</div></div><div class="controls"><button class="btn-primary" onclick="Modules.Countdown.start()">开始</button></div></div></div>
        <div id="page-stopwatch" class="page"><div class="timer-box"><h2>⏲️ 秒表</h2><div class="timer-container"><div class="time-display" id="sw-timer">00:00.00</div></div><div class="controls"><button class="btn-primary" onclick="Modules.Stopwatch.start()">开始</button><button onclick="Modules.Stopwatch.pause()">暂停</button><button class="btn-accent" onclick="Modules.Stopwatch.reset()">清零</button></div></div></div>
        <div id="page-todo" class="page"><div class="timer-box"><h2>✅ 待办</h2><div style="display:flex;gap:10px;margin:20px 0;"><input id="todo-input" class="input-compact" style="flex:1"><button class="btn-primary" onclick="Modules.Todo.add()">添加</button></div><div id="todo-list"></div></div></div>
        <div id="page-favs" class="page"><div class="timer-box"><h2>⭐ 收藏</h2><div id="fav-list" style="margin:20px 0;"></div><div class="controls"><input id="fav-name" placeholder="名"><input id="fav-url" placeholder="URL" style="flex:1"><button class="btn-primary" onclick="Modules.Favs.add()">存</button></div></div></div>
        <div id="page-stats" class="page"><div class="timer-box"><h2>📊 统计</h2><div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;text-align:center;"><div style="background:rgba(0,0,0,0.05);padding:20px;border-radius:10px;"><div>总次数</div><div id="stat-total" style="font-size:2em;font-weight:bold;">0</div></div><div style="background:rgba(0,0,0,0.05);padding:20px;border-radius:10px;"><div>今日(分)</div><div id="stat-today" style="font-size:2em;font-weight:bold;">0</div></div></div></div></div>
        <div id="page-long" class="page"><div class="timer-box"><h2>🎯 目标</h2><div style="text-align:center;margin-top:20px;"><h3>自定义目标</h3><div id="target-display" style="font-size:2em;margin:10px 0;">--</div><input type="datetime-local" id="target-input" onchange="Modules.Long.set('target')"></div></div></div>
        <div id="page-account" class="page"><div class="timer-box"><h2>💾 数据</h2><div class="controls"><button onclick="Data.export()">导出JSON</button><button onclick="document.getElementById('file-in').click()">导入JSON</button><input type="file" id="file-in" hidden onchange="Data.import(this)"></div><button class="btn-accent" style="margin-top:20px;width:100%;" onclick="localStorage.clear();location.reload()">清空数据</button></div></div>
    </div>

    <!-- JS 模块化引用顺序 -->
    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/modules.js"></script>
    <script src="js/app.js"></script>
</body>
</html>